## 执行环境和作用域

js是由一个个执行环境来组成的，最外围的是一个**全局环境**，全局环境包裹着一个个**局部环境**：

```javascript
var color = 'blue';
  function changeColor () {
    if (color === 'blue') {
      color = 'red';
    } else {
      color = 'green';
    }
  }

  changeColor();
  alert('Color is now ' + color); // red
```

上面的代码中，changeColor就是一个局部环境。

每执行一个环境，执行流（**JS引擎**）就会将这个环境放入一个环境栈中，执行完这个环境之后，栈会将这个环境弹出，这个环境的属性和变量会被销毁。执行流有一个控制权，当执行到某一个环境的时候，会将这个控制权交给当前的环境，环境执行完之后，会将控制权移交给之前给他控制权的环境。

在这一层层的控制权交替中，形成了一条**作用域链**，作用域链的每一个节点，就是一个环境，这个节点可以访问到自己环境以及它上层环境的**变量对象**，

